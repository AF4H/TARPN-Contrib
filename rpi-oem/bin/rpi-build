#!/bin/sh
#
# /usr/local/bin/rpi-build
# Wrapper for building RPi OEM images using ~/rpi-oem for artifacts.
#

set -eu

PROJECT_DIR="/srv/TARPN-Contrib/rpi-oem"

if [ ! -d "$PROJECT_DIR" ]; then
  echo "rpi-build: project dir $PROJECT_DIR not found." >&2
  exit 1
fi

export RPI_OEM_WORKDIR="${HOME}/rpi-oem"
mkdir -p "${RPI_OEM_WORKDIR}/artifacts" "${RPI_OEM_WORKDIR}/base-cache"

cd "$PROJECT_DIR"
exec "$PROJECT_DIR/scripts/build-image.sh" "$@"
